<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="qp">
<title>Quantifying protein with qp • qp</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quantifying protein with qp">
<meta property="og:description" content="qp">
<meta property="og:image" content="https://kaiaragaki.github.io/qp/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">qp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/quantifying-protein-with-qp.html">Quantifying protein with qp</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quantifying protein with qp</h1>
            
      
      
      <div class="d-none name"><code>quantifying-protein-with-qp.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kaiaragaki.github.io/qp/">qp</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <a href="https://en.wikipedia.org/wiki/Bicinchoninic_acid_assay#Micro_BCA_assay_(for_dilute_solutions)" class="external-link">Micro
BCA</a> assay and its analysis is easy and straightforward. With most
lab work, though, the analysis is typically repetitive. We can analyze
these data programmatically to speed up and automate analysis, remove
human error, and get reproducibility for free along the way.</p>
<p><code>qp</code> intends to be no-fuss enough where it analyze routine
runs and flexible enough to make analyzing hairier ones simple enough.
In this vignette, I’ll start with a straightforward data set and move to
a more challenging one to show you the two different approaches to
analyzing protein quantification data using <code>qp</code>.</p>
</div>
<div class="section level2">
<h2 id="routine-analysis">Routine analysis<a class="anchor" aria-label="anchor" href="#routine-analysis"></a>
</h2>
<p>The standard <code>qp</code> workflow is based off <a href="https://kai.quarto.pub/bok/western-blot.html#protein-quantification" class="external-link">this</a>
protocol. Provided the protocol is followed, relatively few parameters
need to be changed from their default.</p>
<p>The easiest - and most common - way to read in your data is by
providing a path to your SPECTRAmax file output. These <code>.txt</code>
files are some of the most…creatively…formatted files I’ve come
across.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"absorbances.txt"</span>, package <span class="op">=</span> <span class="st">"qp"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "##BLOCKS= 2          "                                                                                            </span></span>
<span><span class="co">#&gt;  [2] "Plate:\tPlate#1\t1.3\tPlateFormat\tEndpoint\tAbsorbance\tRaw\tFALSE\t1\t\t\t\t\t\t1\t562\t1\t12\t96\t1\t8\tNone\t"</span></span>
<span><span class="co">#&gt;  [3] "\tTemperature(\xa1C)\t1\t2\t3\t4\t5\t6\t7\t8\t9\t10\t11\t12\t\t"                                                  </span></span>
<span><span class="co">#&gt;  [4] "\t37.00\t0.0686\t0.0717\t0.0698\t0.2415\t0.228\t0.2273\t0.0475\t0.0459\t0.0485\t0.0487\t0.0474\t0.0464\t\t"       </span></span>
<span><span class="co">#&gt;  [5] "\t\t0.0825\t0.0832\t0.0835\t0.183\t0.1856\t0.1753\t0.0487\t0.0464\t0.048\t0.0465\t0.0468\t0.047\t\t"              </span></span>
<span><span class="co">#&gt;  [6] "\t\t0.1023\t0.1004\t0.1017\t0.2175\t0.2137\t0.2168\t0.0475\t0.0471\t0.0475\t0.047\t0.0474\t0.0472\t\t"            </span></span>
<span><span class="co">#&gt;  [7] "\t\t0.1322\t0.1324\t0.1371\t0.1241\t0.1248\t0.1213\t0.0482\t0.0475\t0.0476\t0.0477\t0.0474\t0.0479\t\t"           </span></span>
<span><span class="co">#&gt;  [8] "\t\t0.1955\t0.199\t0.1938\t0.0478\t0.0455\t0.0508\t0.046\t0.0465\t0.0479\t0.0512\t0.0477\t0.0465\t\t"             </span></span>
<span><span class="co">#&gt;  [9] "\t\t0.2963\t0.2878\t0.2974\t0.046\t0.0467\t0.0462\t0.0465\t0.0477\t0.0455\t0.0456\t0.0467\t0.046\t\t"             </span></span>
<span><span class="co">#&gt; [10] "\t\t0.4599\t0.4662\t0.4779\t0.0472\t0.0455\t0.0464\t0.0473\t0.0464\t0.0493\t0.0451\t0.0463\t0.0466\t\t"           </span></span>
<span><span class="co">#&gt; [11] "\t\t0.2617\t0.2524\t0.2584\t0.0461\t0.0463\t0.0469\t0.0448\t0.0465\t0.0464\t0.0477\t0.0472\t0.0457\t\t"           </span></span>
<span><span class="co">#&gt; [12] "\t\t"                                                                                                             </span></span>
<span><span class="co">#&gt; [13] "~End"                                                                                                             </span></span>
<span><span class="co">#&gt; [14] "Original Filename: Untitled   Date Last Saved: Unsaved"                                                           </span></span>
<span><span class="co">#&gt; [15] "Copyright \xa9 2003 Molecular Devices. All rights reserved."</span></span></code></pre></div>
<p>Fortunately, I’ve developed a little package <code>mop</code> that
reads in lab data like these. This is used in the <code>qp</code>
function when you provide it a character string.</p>
<p>Typically when you perform these experiments, <em>you</em> will know
how it was laid out. In these data I’m providing, though, I’ll need to
show you how it’s laid out so that you can follow along why I set some
parameters the way I do.</p>
<p>This is how the plate looks:</p>
<p><img src="quantifying-protein-with-qp_files/figure-html/unnamed-chunk-3-1.png" width="1152"></p>
<p>The samples are laid out in triplicate, horizontally arranged
replicates in vertical bands that wrap to the next three columns once it
hits the edge of the plate.</p>
<p><img src="quantifying-protein-with-qp_files/figure-html/unnamed-chunk-4-1.png" width="1152"></p>
<p>Furthermore, I have my seven standards in the top left corner of the
plate, in ascending concentrations as they flow down the first column.
The samples follow. The rest of the wells are empty:</p>
<p><img src="quantifying-protein-with-qp_files/figure-html/unnamed-chunk-5-1.png" width="1152"></p>
<p>Since we followed the standard protocol, and since I told you
replicates were arranged horizontally, analysis is a breeze:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qp.html">qp</a></span><span class="op">(</span><span class="va">f</span>, replicate_orientation <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Please wait. This will take ~10 seconds.</span></span></code></pre></div>
<p>We can plot our standards and samples simply, using
<code>qp_plot_standards</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qp_plot_standards.html">qp_plot_standards</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<p><img src="quantifying-protein-with-qp_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>And we can get a summary of the concentrations using
<code>qp_summarize</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qp_summarize.html">qp_summarize</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="va">summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 3</span></span></span>
<span><span class="co">#&gt;    name       sample_type .mean_pred_conc</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Standard 1 standard           -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">23</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Standard 2 standard            0.102  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Standard 3 standard            0.258  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Standard 4 standard            0.520  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Standard 5 standard            1.08   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Standard 6 standard            2.06   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Standard 7 standard            3.76   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1          unknown             1.71   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2          unknown             1.39   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 3          unknown             0.989  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 4          unknown             1.30   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 5          unknown             0.451</span></span></code></pre></div>
<p>We can also calculate dilutions from this summary. By default, it
will use the lowest concentration of the samples and a final volume of
15uL:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/qp_dilute.html">qp_dilute</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `target_conc` is missing, using lowest sample concentration</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 5</span></span></span>
<span><span class="co">#&gt;    name       sample_type .mean_pred_conc sample_to_add  add_to</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Standard 1 standard           -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">23</span>      -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">088</span>    <span style="text-decoration: underline;">1</span>103   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Standard 2 standard            0.102           66.2   -<span style="color: #BB0000;">51.2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Standard 3 standard            0.258           26.2   -<span style="color: #BB0000;">11.2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Standard 4 standard            0.520           13.0     1.98</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Standard 5 standard            1.08             6.24    8.76</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Standard 6 standard            2.06             3.28   11.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Standard 7 standard            3.76             1.8    13.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1          unknown             1.71             3.97   11.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2          unknown             1.39             4.85   10.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 3          unknown             0.989            6.85    8.15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 4          unknown             1.30             5.23    9.77</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 5          unknown             0.451           15       0</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kai Aragaki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
