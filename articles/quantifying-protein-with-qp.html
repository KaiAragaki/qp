<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="qp">
<title>Quantifying protein with qp • qp</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quantifying protein with qp">
<meta property="og:description" content="qp">
<meta property="og:image" content="https://kaiaragaki.github.io/qp/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">qp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/quantifying-protein-with-qp.html">Quantifying protein with qp</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="quantifying-protein-with-qp_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="quantifying-protein-with-qp_files/viz-1.8.2/viz.js"></script><link href="quantifying-protein-with-qp_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="quantifying-protein-with-qp_files/grViz-binding-1.0.10/grViz.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quantifying protein with qp</h1>
            
      
      
      <div class="d-none name"><code>quantifying-protein-with-qp.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kaiaragaki.github.io/qp/">qp</a></span><span class="op">)</span></span></code></pre></div>
<p>The <a href="https://en.wikipedia.org/wiki/Bicinchoninic_acid_assay#Micro_BCA_assay_(for_dilute_solutions)" class="external-link">Micro
BCA</a> assay and its analysis is easy and straightforward. With most
lab work, though, the analysis is typically repetitive. We can analyze
these data programmatically to speed up and automate analysis, remove
human error, and get reproducibility for free along the way.</p>
<p><code>qp</code> intends to be no-fuss enough where it analyze routine
runs and flexible enough to make analyzing hairier ones simple enough.
In this vignette, I’ll start with a straightforward data set and move to
a more challenging one to show you the two different approaches to
analyzing protein quantification data using <code>qp</code>.</p>
</div>
<div class="section level2">
<h2 id="routine-analysis">Routine analysis<a class="anchor" aria-label="anchor" href="#routine-analysis"></a>
</h2>
<p>The standard <code>qp</code> workflow is based off <a href="https://kai.quarto.pub/bok/western-blot.html#protein-quantification" class="external-link">this</a>
protocol. Provided the protocol is followed, relatively few parameters
need to be changed from their default.</p>
<p>The easiest - and most common - way to read in your data is by
providing a path to your SPECTRAmax file output. These <code>.txt</code>
files are some of the most…creatively…formatted files I’ve come
across.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"absorbances.txt"</span>, package <span class="op">=</span> <span class="st">"qp"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "##BLOCKS= 2          "                                                                                            </span></span>
<span><span class="co">#&gt;  [2] "Plate:\tPlate#1\t1.3\tPlateFormat\tEndpoint\tAbsorbance\tRaw\tFALSE\t1\t\t\t\t\t\t1\t562\t1\t12\t96\t1\t8\tNone\t"</span></span>
<span><span class="co">#&gt;  [3] "\tTemperature(\xa1C)\t1\t2\t3\t4\t5\t6\t7\t8\t9\t10\t11\t12\t\t"                                                  </span></span>
<span><span class="co">#&gt;  [4] "\t37.00\t0.0686\t0.0717\t0.0698\t0.2415\t0.228\t0.2273\t0.0475\t0.0459\t0.0485\t0.0487\t0.0474\t0.0464\t\t"       </span></span>
<span><span class="co">#&gt;  [5] "\t\t0.0825\t0.0832\t0.0835\t0.183\t0.1856\t0.1753\t0.0487\t0.0464\t0.048\t0.0465\t0.0468\t0.047\t\t"              </span></span>
<span><span class="co">#&gt;  [6] "\t\t0.1023\t0.1004\t0.1017\t0.2175\t0.2137\t0.2168\t0.0475\t0.0471\t0.0475\t0.047\t0.0474\t0.0472\t\t"            </span></span>
<span><span class="co">#&gt;  [7] "\t\t0.1322\t0.1324\t0.1371\t0.1241\t0.1248\t0.1213\t0.0482\t0.0475\t0.0476\t0.0477\t0.0474\t0.0479\t\t"           </span></span>
<span><span class="co">#&gt;  [8] "\t\t0.1955\t0.199\t0.1938\t0.0478\t0.0455\t0.0508\t0.046\t0.0465\t0.0479\t0.0512\t0.0477\t0.0465\t\t"             </span></span>
<span><span class="co">#&gt;  [9] "\t\t0.2963\t0.2878\t0.2974\t0.046\t0.0467\t0.0462\t0.0465\t0.0477\t0.0455\t0.0456\t0.0467\t0.046\t\t"             </span></span>
<span><span class="co">#&gt; [10] "\t\t0.4599\t0.4662\t0.4779\t0.0472\t0.0455\t0.0464\t0.0473\t0.0464\t0.0493\t0.0451\t0.0463\t0.0466\t\t"           </span></span>
<span><span class="co">#&gt; [11] "\t\t0.2617\t0.2524\t0.2584\t0.0461\t0.0463\t0.0469\t0.0448\t0.0465\t0.0464\t0.0477\t0.0472\t0.0457\t\t"           </span></span>
<span><span class="co">#&gt; [12] "\t\t"                                                                                                             </span></span>
<span><span class="co">#&gt; [13] "~End"                                                                                                             </span></span>
<span><span class="co">#&gt; [14] "Original Filename: Untitled   Date Last Saved: Unsaved"                                                           </span></span>
<span><span class="co">#&gt; [15] "Copyright \xa9 2003 Molecular Devices. All rights reserved."</span></span></code></pre></div>
<p>Fortunately, I’ve developed a little package <code>mop</code> that
reads in lab data like these. This is used in the <code>qp</code>
function when you provide it a character string.</p>
<p>Typically when you perform these experiments, <em>you</em> will know
how it was laid out. In these data I’m providing, though, I’ll need to
show you how it’s laid out so that you can follow along why I set some
parameters the way I do.</p>
<p>This is how the plate looks:</p>
<p><img src="quantifying-protein-with-qp_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<p>The samples are laid out in triplicate, horizontally arranged
replicates in vertical bands that wrap to the next three columns once it
hits the edge of the plate.</p>
<p><img src="quantifying-protein-with-qp_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<p>Furthermore, I have my seven standards in the top left corner of the
plate, in ascending concentrations as they flow down the first column.
The samples follow. The rest of the wells are empty:</p>
<p><img src="quantifying-protein-with-qp_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<p>Since we followed the standard protocol, and since I told you
replicates were arranged horizontally, analysis is a breeze:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qp.html">qp</a></span><span class="op">(</span><span class="va">f</span>, replicate_orientation <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Please wait. This will take ~10 seconds.</span></span></code></pre></div>
<p>We can plot our standards and samples simply, using
<code>qp_plot_standards</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qp_plot_standards.html">qp_plot_standards</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<p><img src="quantifying-protein-with-qp_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<p>And we can get a summary of the concentrations using
<code>qp_summarize</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qp_summarize.html">qp_summarize</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="va">summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 3</span></span></span>
<span><span class="co">#&gt;    .sample_name sample_type .mean_pred_conc</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Standard 1   standard           -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">23</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Standard 2   standard            0.102  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Standard 3   standard            0.258  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Standard 4   standard            0.520  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Standard 5   standard            1.08   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Standard 6   standard            2.06   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Standard 7   standard            3.76   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1            unknown             1.71   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2            unknown             1.39   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 3            unknown             0.989  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 4            unknown             1.30   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 5            unknown             0.451</span></span></code></pre></div>
<p>We can also calculate dilutions from this summary. By default, it
will use the lowest concentration of the samples and a final volume of
15uL:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/qp_dilute.html">qp_dilute</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `target_conc` is missing, using lowest sample concentration</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 5</span></span></span>
<span><span class="co">#&gt;    .sample_name sample_type .mean_pred_conc sample_to_add  add_to</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Standard 1   standard           -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">23</span>      -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">088</span>    <span style="text-decoration: underline;">1</span>103   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Standard 2   standard            0.102           66.2   -<span style="color: #BB0000;">51.2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Standard 3   standard            0.258           26.2   -<span style="color: #BB0000;">11.2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Standard 4   standard            0.520           13.0     1.98</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Standard 5   standard            1.08             6.24    8.76</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Standard 6   standard            2.06             3.28   11.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Standard 7   standard            3.76             1.8    13.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1            unknown             1.71             3.97   11.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2            unknown             1.39             4.85   10.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 3            unknown             0.989            6.85    8.15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 4            unknown             1.30             5.23    9.77</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 5            unknown             0.451           15       0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="when-things-go-wrong">When things go wrong<a class="anchor" aria-label="anchor" href="#when-things-go-wrong"></a>
</h2>
<p>Occasionally, your experiment won’t go perfectly - maybe you mixed up
the order of the standards, or could can’t run samples with technical
replicates. In this case, you can run the functions that <code>qp</code>
runs individually, maybe doing a little data munging between steps.</p>
<p>Most functions depend on a previous function being run. See the
following hierarchy to see what functions depend on what:</p>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-10eed6cb8c380c3ed702" style="width:100%;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-10eed6cb8c380c3ed702">{"x":{"diagram":"\ndigraph qp_deps {\n  rankdir=BT\n  graph [overlap = true, fontsize = 10]\n\n  node [shape = box,\n        fontname = Helvetica]\n  tidy; calc_abs_mean; add_std_conc; add_names; plot_plate; fit;\n  calc_conc; summarize; dilute; remove_empty; plot_standards\n\n  calc_abs_mean->tidy\n  add_std_conc->tidy\n  add_names->tidy\n  plot_plate->tidy\n  fit->calc_abs_mean\n  fit->add_std_conc\n  calc_conc->fit\n  summarize->calc_conc\n  dilute->calc_conc\n  remove_empty->calc_conc\n  plot_standards->calc_conc\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><div class="section level3">
<h3 id="reading-in-the-data">Reading in the data<a class="anchor" aria-label="anchor" href="#reading-in-the-data"></a>
</h3>
<p>There are a couple ways of going about doing this. Depending on how
borked your plate is, the most straightforward way may be to create a
<code>data.frame</code> with columns <code>sample_type</code> (which
should contain <code>standard</code> or <code>unknown</code>),
<code>index</code> (which denotes the standard or sample number), and
<code>.abs</code> (the absorbances at - hopefully but not necessarily -
562nm):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standards</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  sample_type <span class="op">=</span> <span class="st">"standard"</span>,</span>
<span>  index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  abs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.071</span>, <span class="fl">0.079</span>, <span class="fl">0.08</span>, <span class="fl">0.082</span>,</span>
<span>          <span class="fl">0.1</span>, <span class="fl">0.099</span>, <span class="fl">0.15</span>, <span class="fl">0.147</span>,</span>
<span>          <span class="fl">0.22</span>, <span class="fl">0.215</span>, <span class="fl">0.50</span>, <span class="fl">0.48</span>, <span class="fl">0.78</span>, <span class="fl">0.79</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">unknowns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample_type <span class="op">=</span> <span class="st">"unknown"</span>, index <span class="op">=</span> <span class="fl">1</span>, abs <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">standards</span>, <span class="va">unknowns</span><span class="op">)</span></span>
<span><span class="va">data</span></span>
<span><span class="co">#&gt;    sample_type index   abs</span></span>
<span><span class="co">#&gt; 1     standard     1 0.071</span></span>
<span><span class="co">#&gt; 2     standard     1 0.079</span></span>
<span><span class="co">#&gt; 3     standard     2 0.080</span></span>
<span><span class="co">#&gt; 4     standard     2 0.082</span></span>
<span><span class="co">#&gt; 5     standard     3 0.100</span></span>
<span><span class="co">#&gt; 6     standard     3 0.099</span></span>
<span><span class="co">#&gt; 7     standard     4 0.150</span></span>
<span><span class="co">#&gt; 8     standard     4 0.147</span></span>
<span><span class="co">#&gt; 9     standard     5 0.220</span></span>
<span><span class="co">#&gt; 10    standard     5 0.215</span></span>
<span><span class="co">#&gt; 11    standard     6 0.500</span></span>
<span><span class="co">#&gt; 12    standard     6 0.480</span></span>
<span><span class="co">#&gt; 13    standard     7 0.780</span></span>
<span><span class="co">#&gt; 14    standard     7 0.790</span></span>
<span><span class="co">#&gt; 15     unknown     1 0.250</span></span></code></pre></div>
<p>Admittedly, this does destroy the whole ‘reproducibility’ aspect of
it. Another way of going doing this is via <a href="https://kaiaragaki.github.io/gplate/articles/gp_for_data.html" class="external-link"><code>gplate</code></a></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kaiaragaki.github.io/mop/" class="external-link">mop</a></span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"absorbances.txt"</span>, package <span class="op">=</span> <span class="st">"qp"</span><span class="op">)</span></span>
<span><span class="va">spectramax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kaiaragaki.github.io/mop/reference/read_spectramax.html" class="external-link">read_spectramax</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co">#&gt; Please wait. This will take ~10 seconds.</span></span>
<span><span class="va">spectramax</span></span>
<span><span class="co">#&gt; &lt;spectramax[5]&gt;</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #555555;">#&gt;                 </span>12</span></span>
<span><span class="co"><span style="color: #555555;">#&gt;    ________________________</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span>8<span style="color: #555555;"> | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Start corner: </span>tl</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Plate dimensions: </span>8 x 12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$type</span></span>
<span><span class="co">#&gt; [1] "Plate"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$wavelengths</span></span>
<span><span class="co">#&gt; [1] "562"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"># Wavelengths:</span> 562 </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"># Is tidy:</span> <span style="color: #0000BB;">TRUE</span> </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"># Date:</span> 2023-11-04</span></span></code></pre></div>
<p>We can extract the <code>gp</code> from the <code>spectramax</code>
object via:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># I know it's ugly syntax - I'll work on it. Later.</span></span>
<span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="va">spectramax</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">gp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #555555;">#&gt;                 </span>12</span></span>
<span><span class="co"><span style="color: #555555;">#&gt;    ________________________</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span>8<span style="color: #555555;"> | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Start corner: </span>tl</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Plate dimensions: </span>8 x 12</span></span></code></pre></div>
<p>And then we can carve out rectangular sections using
<code><a href="https://rdrr.io/pkg/gplate/man/gp_excise.html" class="external-link">gplate::gp_excise</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kaiaragaki.github.io/gp/" class="external-link">gplate</a></span><span class="op">)</span></span>
<span><span class="va">standards</span> <span class="op">&lt;-</span> <span class="va">gp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/gplate/man/gp_excise.html" class="external-link">gp_excise</a></span><span class="op">(</span>top <span class="op">=</span> <span class="fl">1</span>, left <span class="op">=</span> <span class="fl">1</span>, bottom <span class="op">=</span> <span class="fl">7</span>, right <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/gplate/man/gp_serve.html" class="external-link">gp_serve</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    sample_type <span class="op">=</span> <span class="st">"standard"</span>,</span>
<span>    index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="va">gp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/gplate/man/gp_excise.html" class="external-link">gp_excise</a></span><span class="op">(</span>top <span class="op">=</span> <span class="fl">1</span>, left <span class="op">=</span> <span class="fl">4</span>, bottom <span class="op">=</span> <span class="fl">1</span>, right <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/gplate/man/gp_serve.html" class="external-link">gp_serve</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    sample_type <span class="op">=</span> <span class="st">"unknown"</span>,</span>
<span>    index <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">standards</span>, <span class="va">samples</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>.abs <span class="op">=</span> <span class="va">nm562</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 5</span></span></span>
<span><span class="co">#&gt;     .row  .col   .abs sample_type index</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.068<span style="text-decoration: underline;">6</span> standard        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     2 0.071<span style="text-decoration: underline;">7</span> standard        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     2     1 0.082<span style="text-decoration: underline;">5</span> standard        2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     2     2 0.083<span style="text-decoration: underline;">2</span> standard        2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     3     1 0.102  standard        3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     3     2 0.100  standard        3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     4     1 0.132  standard        4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     4     2 0.132  standard        4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     5     1 0.196  standard        5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     5     2 0.199  standard        5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     6     1 0.296  standard        6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>     6     2 0.288  standard        6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>     7     1 0.460  standard        7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>     7     2 0.466  standard        7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>     1     1 0.242  unknown         1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-standard-concentrations">Adding standard concentrations<a class="anchor" aria-label="anchor" href="#adding-standard-concentrations"></a>
</h3>
<p>Suppose you accidentally made your highest standard twice as
concentrated. That’s a simple fix. Instead of using the standard
standards:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.000 0.125 0.250 0.500 1.000 2.000 4.000</span></span></code></pre></div>
<p>You can set your own:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.000 0.125 0.250 0.500 1.000 2.000 8.000</span></span></code></pre></div>
<p>and use them as an argument in <code>qp_add_std_conc</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qp_add_std_conc.html">qp_add_std_conc</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 6</span></span></span>
<span><span class="co">#&gt;     .row  .col   .abs sample_type index  .conc</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.068<span style="text-decoration: underline;">6</span> standard        1  0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     2 0.071<span style="text-decoration: underline;">7</span> standard        1  0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     2     1 0.082<span style="text-decoration: underline;">5</span> standard        2  0.125</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     2     2 0.083<span style="text-decoration: underline;">2</span> standard        2  0.125</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     3     1 0.102  standard        3  0.25 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     3     2 0.100  standard        3  0.25 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     4     1 0.132  standard        4  0.5  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     4     2 0.132  standard        4  0.5  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     5     1 0.196  standard        5  1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     5     2 0.199  standard        5  1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     6     1 0.296  standard        6  2    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>     6     2 0.288  standard        6  2    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>     7     1 0.460  standard        7  8    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>     7     2 0.466  standard        7  8    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>     1     1 0.242  unknown         1 <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>You can specify them as strangely as you want:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qp_add_std_conc.html">qp_add_std_conc</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">26</span>, <span class="fl">0.4</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 6</span></span></span>
<span><span class="co">#&gt;     .row  .col   .abs sample_type index .conc</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.068<span style="text-decoration: underline;">6</span> standard        1   1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     2 0.071<span style="text-decoration: underline;">7</span> standard        1   1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     2     1 0.082<span style="text-decoration: underline;">5</span> standard        2   7  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     2     2 0.083<span style="text-decoration: underline;">2</span> standard        2   7  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     3     1 0.102  standard        3  26  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     3     2 0.100  standard        3  26  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     4     1 0.132  standard        4   0.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     4     2 0.132  standard        4   0.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     5     1 0.196  standard        5   2  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     5     2 0.199  standard        5   2  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     6     1 0.296  standard        6   1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>     6     2 0.288  standard        6   1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>     7     1 0.460  standard        7   1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>     7     2 0.466  standard        7   1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>     1     1 0.242  unknown         1  <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculating-absorbance-means">Calculating absorbance means<a class="anchor" aria-label="anchor" href="#calculating-absorbance-means"></a>
</h3>
<p>At some point - either before or after calculating your standard
concentrations - you’ll need to calculate the means of your absorbances.
In an Excel based format, you might manually remove outliers - but what
counts as an ‘outlier’ is somewhat arbitrary in that setting. You can
optionally remove outliers in a systematic way with <code>qp</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some_abs</span> <span class="op">&lt;-</span> <span class="va">absorbances</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">21</span><span class="op">:</span><span class="fl">26</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">some_abs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/qp_calc_abs_mean.html">qp_calc_abs_mean</a></span><span class="op">(</span>ignore_outliers <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 7</span></span></span>
<span><span class="co">#&gt;     .row  .col   .abs sample_type index .is_outlier  .mean</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.070<span style="text-decoration: underline;">7</span> standard        1 <span style="color: #BB0000;">NA</span>          0.073<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2     1 0.078<span style="text-decoration: underline;">6</span> standard        1 <span style="color: #BB0000;">NA</span>          0.073<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3     1 0.071<span style="text-decoration: underline;">4</span> standard        1 <span style="color: #BB0000;">NA</span>          0.073<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     2 0.079<span style="text-decoration: underline;">5</span> standard        2 <span style="color: #BB0000;">NA</span>          0.079<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     2     2 0.079<span style="text-decoration: underline;">9</span> standard        2 <span style="color: #BB0000;">NA</span>          0.079<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     3     7 0.792  standard        7 <span style="color: #BB0000;">NA</span>          0.792 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     8 0.456  unknown         1 <span style="color: #BB0000;">NA</span>          0.457 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     8 0.459  unknown         1 <span style="color: #BB0000;">NA</span>          0.457 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     3     8 0.455  unknown         1 <span style="color: #BB0000;">NA</span>          0.457 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1     9 0.446  unknown         2 <span style="color: #BB0000;">NA</span>          0.444 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     2     9 0.441  unknown         2 <span style="color: #BB0000;">NA</span>          0.444</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some_abs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/qp_calc_abs_mean.html">qp_calc_abs_mean</a></span><span class="op">(</span>ignore_outliers <span class="op">=</span> <span class="st">"standards"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 7</span></span></span>
<span><span class="co">#&gt;     .row  .col   .abs sample_type index .is_outlier  .mean</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.070<span style="text-decoration: underline;">7</span> standard        1 FALSE       0.071<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2     1 0.078<span style="text-decoration: underline;">6</span> standard        1 TRUE        0.071<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3     1 0.071<span style="text-decoration: underline;">4</span> standard        1 FALSE       0.071<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     2 0.079<span style="text-decoration: underline;">5</span> standard        2 FALSE       0.079<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     2     2 0.079<span style="text-decoration: underline;">9</span> standard        2 FALSE       0.079<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     3     7 0.792  standard        7 FALSE       0.792 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     8 0.456  unknown         1 <span style="color: #BB0000;">NA</span>          0.457 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     8 0.459  unknown         1 <span style="color: #BB0000;">NA</span>          0.457 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     3     8 0.455  unknown         1 <span style="color: #BB0000;">NA</span>          0.457 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1     9 0.446  unknown         2 <span style="color: #BB0000;">NA</span>          0.444 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     2     9 0.441  unknown         2 <span style="color: #BB0000;">NA</span>          0.444</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some_abs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/qp_calc_abs_mean.html">qp_calc_abs_mean</a></span><span class="op">(</span>ignore_outliers <span class="op">=</span> <span class="st">"samples"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 7</span></span></span>
<span><span class="co">#&gt;     .row  .col   .abs sample_type index .is_outlier  .mean</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.070<span style="text-decoration: underline;">7</span> standard        1 <span style="color: #BB0000;">NA</span>          0.073<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2     1 0.078<span style="text-decoration: underline;">6</span> standard        1 <span style="color: #BB0000;">NA</span>          0.073<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3     1 0.071<span style="text-decoration: underline;">4</span> standard        1 <span style="color: #BB0000;">NA</span>          0.073<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     2 0.079<span style="text-decoration: underline;">5</span> standard        2 <span style="color: #BB0000;">NA</span>          0.079<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     2     2 0.079<span style="text-decoration: underline;">9</span> standard        2 <span style="color: #BB0000;">NA</span>          0.079<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     3     7 0.792  standard        7 <span style="color: #BB0000;">NA</span>          0.792 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     8 0.456  unknown         1 FALSE       0.455 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     8 0.459  unknown         1 TRUE        0.455 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     3     8 0.455  unknown         1 FALSE       0.455 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1     9 0.446  unknown         2 FALSE       0.444 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     2     9 0.441  unknown         2 FALSE       0.444</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">some_abs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/qp_calc_abs_mean.html">qp_calc_abs_mean</a></span><span class="op">(</span>ignore_outliers <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 7</span></span></span>
<span><span class="co">#&gt;     .row  .col   .abs sample_type index .is_outlier  .mean</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.070<span style="text-decoration: underline;">7</span> standard        1 FALSE       0.071<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2     1 0.078<span style="text-decoration: underline;">6</span> standard        1 TRUE        0.071<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3     1 0.071<span style="text-decoration: underline;">4</span> standard        1 FALSE       0.071<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     2 0.079<span style="text-decoration: underline;">5</span> standard        2 FALSE       0.079<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     2     2 0.079<span style="text-decoration: underline;">9</span> standard        2 FALSE       0.079<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     3     7 0.792  standard        7 FALSE       0.792 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     8 0.456  unknown         1 FALSE       0.455 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     8 0.459  unknown         1 TRUE        0.455 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     3     8 0.455  unknown         1 FALSE       0.455 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1     9 0.446  unknown         2 FALSE       0.444 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     2     9 0.441  unknown         2 FALSE       0.444</span></span></code></pre></div>
<p>Something is an outlier if it is over 3 standard deviations away from
the mean of the others. While this might mark things as outliers that
you might not (perhaps because the other two samples were just ultra
close to each other), it only has a downstream effect if these outliers
are truly much different from the others.</p>
</div>
<div class="section level3">
<h3 id="fitting-a-model">Fitting a model<a class="anchor" aria-label="anchor" href="#fitting-a-model"></a>
</h3>
<p>Once the above steps have been completed, you can fit a simple linear
model:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">absorbances</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/qp_add_std_conc.html">qp_add_std_conc</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># all values are defaults</span></span>
<span>  <span class="fu"><a href="../reference/qp_calc_abs_mean.html">qp_calc_abs_mean</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/qp_fit.html">qp_fit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `sample_type` contains values other than `standard` and `unknown`</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> These values may be ignored downstream!</span></span>
<span><span class="co">#&gt; Did not find column `.log2_abs`, calculating.</span></span>
<span></span>
<span><span class="va">out</span></span>
<span><span class="co">#&gt; $fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = .log2_conc ~ .log2_abs, data = fit_data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)    .log2_abs  </span></span>
<span><span class="co">#&gt;       2.378        0.850  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qp</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 88 × 9</span></span></span>
<span><span class="co">#&gt;     .row  .col   .abs sample_type index .conc .is_outlier  .mean .log2_abs</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.070<span style="text-decoration: underline;">7</span> standard        1 0     FALSE       0.071<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.82</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2     1 0.078<span style="text-decoration: underline;">6</span> standard        1 0     TRUE        0.071<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.67</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3     1 0.071<span style="text-decoration: underline;">4</span> standard        1 0     FALSE       0.071<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.81</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     2 0.079<span style="text-decoration: underline;">5</span> standard        2 0.125 FALSE       0.080<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.65</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     2     2 0.079<span style="text-decoration: underline;">9</span> standard        2 0.125 FALSE       0.080<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.65</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     3     2 0.080<span style="text-decoration: underline;">5</span> standard        2 0.125 FALSE       0.080<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.63</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     3 0.099<span style="text-decoration: underline;">9</span> standard        3 0.25  FALSE       0.097<span style="text-decoration: underline;">7</span>     -<span style="color: #BB0000;">3.32</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     3 0.095<span style="text-decoration: underline;">5</span> standard        3 0.25  FALSE       0.097<span style="text-decoration: underline;">7</span>     -<span style="color: #BB0000;">3.39</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     3     3 0.097<span style="text-decoration: underline;">6</span> standard        3 0.25  FALSE       0.097<span style="text-decoration: underline;">7</span>     -<span style="color: #BB0000;">3.36</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1     4 0.151  standard        4 0.5   TRUE        0.148      -<span style="color: #BB0000;">2.72</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 78 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="predicting-concentrations">Predicting concentrations<a class="anchor" aria-label="anchor" href="#predicting-concentrations"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qp_calc_conc.html">qp_calc_conc</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="va">conc</span></span>
<span><span class="co">#&gt; $fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = .log2_conc ~ .log2_abs, data = fit_data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)    .log2_abs  </span></span>
<span><span class="co">#&gt;       2.378        0.850  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qp</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 88 × 12</span></span></span>
<span><span class="co">#&gt;     .row  .col   .abs sample_type index .conc .is_outlier  .mean .log2_abs</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.070<span style="text-decoration: underline;">7</span> standard        1 0     FALSE       0.071<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.82</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2     1 0.078<span style="text-decoration: underline;">6</span> standard        1 0     TRUE        0.071<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.67</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3     1 0.071<span style="text-decoration: underline;">4</span> standard        1 0     FALSE       0.071<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.81</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     2 0.079<span style="text-decoration: underline;">5</span> standard        2 0.125 FALSE       0.080<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.65</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     2     2 0.079<span style="text-decoration: underline;">9</span> standard        2 0.125 FALSE       0.080<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.65</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     3     2 0.080<span style="text-decoration: underline;">5</span> standard        2 0.125 FALSE       0.080<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">3.63</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     3 0.099<span style="text-decoration: underline;">9</span> standard        3 0.25  FALSE       0.097<span style="text-decoration: underline;">7</span>     -<span style="color: #BB0000;">3.32</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     3 0.095<span style="text-decoration: underline;">5</span> standard        3 0.25  FALSE       0.097<span style="text-decoration: underline;">7</span>     -<span style="color: #BB0000;">3.39</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     3     3 0.097<span style="text-decoration: underline;">6</span> standard        3 0.25  FALSE       0.097<span style="text-decoration: underline;">7</span>     -<span style="color: #BB0000;">3.36</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1     4 0.151  standard        4 0.5   TRUE        0.148      -<span style="color: #BB0000;">2.72</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 78 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: .pred &lt;dbl&gt;, .pred_conc &lt;dbl&gt;, .pred_conc_mean &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="removing-empty-wells">Removing empty wells<a class="anchor" aria-label="anchor" href="#removing-empty-wells"></a>
</h3>
<p>Samples that have a predicted concentration lower than 0 can be
removed easily using <code>qp_remove_empty</code>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conc</span><span class="op">$</span><span class="va">qp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 12</span></span></span>
<span><span class="co">#&gt;    .row  .col   .abs sample_type index .conc .is_outlier  .mean .log2_abs .pred</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     7     6 0.048  unknown        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span> FALSE       0.048<span style="text-decoration: underline;">5</span>     -<span style="color: #BB0000;">4.38</span> -<span style="color: #BB0000;">1.35</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     8     6 0.046<span style="text-decoration: underline;">9</span> unknown        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span> FALSE       0.048<span style="text-decoration: underline;">5</span>     -<span style="color: #BB0000;">4.41</span> -<span style="color: #BB0000;">1.37</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     7     7 0.049<span style="text-decoration: underline;">9</span> unknown        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span> FALSE       0.048<span style="text-decoration: underline;">5</span>     -<span style="color: #BB0000;">4.32</span> -<span style="color: #BB0000;">1.30</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     8     7 0.048<span style="text-decoration: underline;">3</span> unknown        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span> FALSE       0.048<span style="text-decoration: underline;">5</span>     -<span style="color: #BB0000;">4.37</span> -<span style="color: #BB0000;">1.34</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     7     8 0.048<span style="text-decoration: underline;">5</span> unknown        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span> FALSE       0.048<span style="text-decoration: underline;">5</span>     -<span style="color: #BB0000;">4.37</span> -<span style="color: #BB0000;">1.33</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     8     8 0.048<span style="text-decoration: underline;">7</span> unknown        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span> FALSE       0.048<span style="text-decoration: underline;">5</span>     -<span style="color: #BB0000;">4.36</span> -<span style="color: #BB0000;">1.33</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: .pred_conc &lt;dbl&gt;, .pred_conc_mean &lt;dbl&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no_zero</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qp_remove_empty.html">qp_remove_empty</a></span><span class="op">(</span><span class="va">conc</span><span class="op">)</span></span>
<span><span class="va">no_zero</span><span class="op">$</span><span class="va">qp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 12</span></span></span>
<span><span class="co">#&gt;    .row  .col  .abs sample_type index .conc .is_outlier .mean .log2_abs .pred</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     4     2 0.379 unknown         7    <span style="color: #BB0000;">NA</span> FALSE       0.378     -<span style="color: #BB0000;">1.40</span> 1.19 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     5     2 0.370 unknown         7    <span style="color: #BB0000;">NA</span> TRUE        0.378     -<span style="color: #BB0000;">1.44</span> 1.16 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     6     2 0.376 unknown         7    <span style="color: #BB0000;">NA</span> FALSE       0.378     -<span style="color: #BB0000;">1.41</span> 1.18 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4     3 0.228 unknown         8    <span style="color: #BB0000;">NA</span> TRUE        0.218     -<span style="color: #BB0000;">2.13</span> 0.565</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     5     3 0.217 unknown         8    <span style="color: #BB0000;">NA</span> FALSE       0.218     -<span style="color: #BB0000;">2.20</span> 0.504</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     6     3 0.220 unknown         8    <span style="color: #BB0000;">NA</span> FALSE       0.218     -<span style="color: #BB0000;">2.19</span> 0.520</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: .pred_conc &lt;dbl&gt;, .pred_conc_mean &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Note that this typically won’t remove wells that have the BCA
solution in it but have no sample.</p>
</div>
<div class="section level3">
<h3 id="adding-sample-names">Adding sample names<a class="anchor" aria-label="anchor" href="#adding-sample-names"></a>
</h3>
<p>At any point, you can add sample names to the data - each index gets
its own sample name.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">with_names</span> <span class="op">&lt;-</span> <span class="va">no_zero</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/qp_add_names.html">qp_add_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"my_sample_"</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">with_names</span><span class="op">$</span><span class="va">qp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 13</span></span></span>
<span><span class="co">#&gt;    .row  .col  .abs sample_type index .conc .is_outlier .mean .log2_abs .pred</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     4     2 0.379 unknown         7    <span style="color: #BB0000;">NA</span> FALSE       0.378     -<span style="color: #BB0000;">1.40</span> 1.19 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     5     2 0.370 unknown         7    <span style="color: #BB0000;">NA</span> TRUE        0.378     -<span style="color: #BB0000;">1.44</span> 1.16 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     6     2 0.376 unknown         7    <span style="color: #BB0000;">NA</span> FALSE       0.378     -<span style="color: #BB0000;">1.41</span> 1.18 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4     3 0.228 unknown         8    <span style="color: #BB0000;">NA</span> TRUE        0.218     -<span style="color: #BB0000;">2.13</span> 0.565</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     5     3 0.217 unknown         8    <span style="color: #BB0000;">NA</span> FALSE       0.218     -<span style="color: #BB0000;">2.20</span> 0.504</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     6     3 0.220 unknown         8    <span style="color: #BB0000;">NA</span> FALSE       0.218     -<span style="color: #BB0000;">2.19</span> 0.520</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: .pred_conc &lt;dbl&gt;, .pred_conc_mean &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   .sample_name &lt;chr&gt;</span></span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kai Aragaki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
